"use strict";
"use strict";

document.addEventListener('DOMContentLoaded', function () {
  var currentIndex = 0;
  var startX = 0;
  var isDragging = false;
  var slider = document.querySelector('.formula__slider');
  var items = document.querySelectorAll('.formula__item');
  var totalItems = items.length;
  function updateSlider() {
    items.forEach(function (item, index) {
      var distance = index - currentIndex;
      var newPosition = distance * 50;
      if (distance > totalItems / 2) {
        newPosition -= totalItems * 50;
      } else if (distance < -totalItems / 2) {
        newPosition += totalItems * 50;
      }
      var scale = index === currentIndex ? 1 : 0.8;
      item.style.transform = "translateX(".concat(newPosition, "%) scale(").concat(scale, ")");
      item.style.zIndex = index === currentIndex ? 2 : 1;
      var isVisible = Math.abs(distance) <= 1 || index === 0 && currentIndex === totalItems - 1 || index === totalItems - 1 && currentIndex === 0;
      item.classList.toggle('hidden', !isVisible);
      item.classList.toggle('active', index === currentIndex);
      item.classList.remove('left-slide', 'right-slide');
      if (distance === 1 || currentIndex === totalItems - 1 && index === 0) {
        item.classList.add('right-slide');
      } else if (distance === -1 || currentIndex === 0 && index === totalItems - 1) {
        item.classList.add('left-slide');
      }

      //Showing blocks
      var winnerBlock = document.querySelector('.winner');
      var chooseBlock = document.querySelector('.choose');
      var closedBlock = document.querySelector('.closed');
      if (item.dataset.block === 'winner' && item.classList.contains('active')) {
        winnerBlock.classList.remove('_hidden');
        chooseBlock.classList.add('_hidden');
        closedBlock.classList.add('_hidden');
      }
      if (item.dataset.block === 'choose' && item.classList.contains('active')) {
        chooseBlock.classList.remove('_hidden');
        winnerBlock.classList.add('_hidden');
        closedBlock.classList.add('_hidden');
      }
      if (item.dataset.block === 'closed' && item.classList.contains('active')) {
        closedBlock.classList.remove('_hidden');
        winnerBlock.classList.add('_hidden');
        chooseBlock.classList.add('_hidden');
      }
    });
  }
  function moveSlider(offset) {
    currentIndex = (currentIndex + offset + totalItems) % totalItems;
    updateSlider();
  }
  function handleStart(event) {
    isDragging = true;
    startX = event.clientX || event.touches[0].clientX;
  }
  function handleMove(event) {
    if (!isDragging) return;
    var currentX = event.clientX || event.touches[0].clientX;
    var diffX = currentX - startX;
    if (Math.abs(diffX) > 50) {
      moveSlider(diffX > 0 ? -1 : 1);
      isDragging = false;
    }
  }
  function handleEnd() {
    isDragging = false;
  }
  var buttonsLeft = document.querySelectorAll('.formula__control-left');
  var buttonsRight = document.querySelectorAll('.formula__control-right');
  buttonsLeft.forEach(function (btn) {
    btn.addEventListener('click', function () {
      moveSlider(-1);
    });
  });
  buttonsRight.forEach(function (btn) {
    btn.addEventListener('click', function () {
      moveSlider(1);
    });
  });
  slider.addEventListener('mousedown', handleStart);
  slider.addEventListener('touchstart', handleStart);
  document.addEventListener('mousemove', handleMove);
  document.addEventListener('touchmove', handleMove);
  document.addEventListener('mouseup', handleEnd);
  document.addEventListener('touchend', handleEnd);
  updateSlider();
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJzZWNvbmQuanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiY3VycmVudEluZGV4Iiwic3RhcnRYIiwiaXNEcmFnZ2luZyIsInNsaWRlciIsInF1ZXJ5U2VsZWN0b3IiLCJpdGVtcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJ0b3RhbEl0ZW1zIiwibGVuZ3RoIiwidXBkYXRlU2xpZGVyIiwiZm9yRWFjaCIsIml0ZW0iLCJpbmRleCIsImRpc3RhbmNlIiwibmV3UG9zaXRpb24iLCJzY2FsZSIsInN0eWxlIiwidHJhbnNmb3JtIiwiY29uY2F0IiwiekluZGV4IiwiaXNWaXNpYmxlIiwiTWF0aCIsImFicyIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInJlbW92ZSIsImFkZCIsIndpbm5lckJsb2NrIiwiY2hvb3NlQmxvY2siLCJjbG9zZWRCbG9jayIsImRhdGFzZXQiLCJibG9jayIsImNvbnRhaW5zIiwibW92ZVNsaWRlciIsIm9mZnNldCIsImhhbmRsZVN0YXJ0IiwiZXZlbnQiLCJjbGllbnRYIiwidG91Y2hlcyIsImhhbmRsZU1vdmUiLCJjdXJyZW50WCIsImRpZmZYIiwiaGFuZGxlRW5kIiwiYnV0dG9uc0xlZnQiLCJidXR0b25zUmlnaHQiLCJidG4iXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQUEsUUFBUSxDQUFDQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxZQUFZO0VBQ3RELElBQUlDLFlBQVksR0FBRyxDQUFDO0VBQ3BCLElBQUlDLE1BQU0sR0FBRyxDQUFDO0VBQ2QsSUFBSUMsVUFBVSxHQUFHLEtBQUs7RUFFdEIsSUFBTUMsTUFBTSxHQUFHTCxRQUFRLENBQUNNLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQztFQUN6RCxJQUFNQyxLQUFLLEdBQUdQLFFBQVEsQ0FBQ1EsZ0JBQWdCLENBQUMsZ0JBQWdCLENBQUM7RUFDekQsSUFBTUMsVUFBVSxHQUFHRixLQUFLLENBQUNHLE1BQU07RUFFL0IsU0FBU0MsWUFBWUEs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QUMsQ0FBQyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIiwiZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgY3VycmVudEluZGV4ID0gMDtcbiAgICBsZXQgc3RhcnRYID0gMDtcbiAgICBsZXQgaXNEcmFnZ2luZyA9IGZhbHNlO1xuXG4gICAgY29uc3Qgc2xpZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm11bGFfX3NsaWRlcicpO1xuICAgIGNvbnN0IGl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZvcm11bGFfX2l0ZW0nKTtcbiAgICBjb25zdCB0b3RhbEl0ZW1zID0gaXRlbXMubGVuZ3RoO1xuXG4gICAgZnVuY3Rpb24gdXBkYXRlU2xpZGVyKCkge1xuICAgICAgICBpdGVtcy5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZGlzdGFuY2UgPSBpbmRleCAtIGN1cnJlbnRJbmRleDtcbiAgICAgICAgICAgIGxldCBuZXdQb3NpdGlvbiA9IGRpc3RhbmNlICogNTA7XG5cbiAgICAgICAgICAgIGlmIChkaXN0YW5jZSA+IHRvdGFsSXRlbXMgLyAyKSB7XG4gICAgICAgICAgICAgICAgbmV3UG9zaXRpb24gLT0gdG90YWxJdGVtcyAqIDUwO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChkaXN0YW5jZSA8IC10b3RhbEl0ZW1zIC8gMikge1xuICAgICAgICAgICAgICAgIG5ld1Bvc2l0aW9uICs9IHRvdGFsSXRlbXMgKiA1MDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3Qgc2NhbGUgPSBpbmRleCA9PT0gY3VycmVudEluZGV4ID8gMSA6IDAuODtcblxuICAgICAgICAgICAgaXRlbS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWCgke25ld1Bvc2l0aW9ufSUpIHNjYWxlKCR7c2NhbGV9KWA7XG4gICAgICAgICAgICBpdGVtLnN0eWxlLnpJbmRleCA9IGluZGV4ID09PSBjdXJyZW50SW5kZXggPyAyIDogMTtcblxuICAgICAgICAgICAgY29uc3QgaXNWaXNpYmxlID0gTWF0aC5hYnMoZGlzdGFuY2UpIDw9IDEgfHwgKGluZGV4ID09PSAwICYmIGN1cnJlbnRJbmRleCA9PT0gdG90YWxJdGVtcyAtIDEpIHx8IChpbmRleCA9PT0gdG90YWxJdGVtcyAtIDEgJiYgY3VycmVudEluZGV4ID09PSAwKTtcbiAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJywgIWlzVmlzaWJsZSk7XG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIGluZGV4ID09PSBjdXJyZW50SW5kZXgpO1xuXG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2xlZnQtc2xpZGUnLCAncmlnaHQtc2xpZGUnKTtcbiAgICAgICAgICAgIGlmIChkaXN0YW5jZSA9PT0gMSB8fCAoY3VycmVudEluZGV4ID09PSB0b3RhbEl0ZW1zIC0gMSAmJiBpbmRleCA9PT0gMCkpIHtcbiAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ3JpZ2h0LXNsaWRlJyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRpc3RhbmNlID09PSAtMSB8fCAoY3VycmVudEluZGV4ID09PSAwICYmIGluZGV4ID09PSB0b3RhbEl0ZW1zIC0gMSkpIHtcbiAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ2xlZnQtc2xpZGUnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9TaG93aW5nIGJsb2Nrc1xuICAgICAgICAgICAgY29uc3Qgd2lubmVyQmxvY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud2lubmVyJylcbiAgICAgICAgICAgIGNvbnN0IGNob29zZUJsb2NrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNob29zZScpXG4gICAgICAgICAgICBjb25zdCBjbG9zZWRCbG9jayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jbG9zZWQnKVxuXG4gICAgICAgICAgICBpZihpdGVtLmRhdGFzZXQuYmxvY2sgPT09ICd3aW5uZXInICYmIGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSl7XG4gICAgICAgICAgICAgICAgd2lubmVyQmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnX2hpZGRlbicpXG4gICAgICAgICAgICAgICAgY2hvb3NlQmxvY2suY2xhc3NMaXN0LmFkZCgnX2hpZGRlbicpXG4gICAgICAgICAgICAgICAgY2xvc2VkQmxvY2suY2xhc3NMaXN0LmFkZCgnX2hpZGRlbicpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihpdGVtLmRhdGFzZXQuYmxvY2sgPT09ICdjaG9vc2UnICYmIGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSl7XG4gICAgICAgICAgICAgICAgY2hvb3NlQmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnX2hpZGRlbicpXG4gICAgICAgICAgICAgICAgd2lubmVyQmxvY2suY2xhc3NMaXN0LmFkZCgnX2hpZGRlbicpXG4gICAgICAgICAgICAgICAgY2xvc2VkQmxvY2suY2xhc3NMaXN0LmFkZCgnX2hpZGRlbicpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihpdGVtLmRhdGFzZXQuYmxvY2sgPT09ICdjbG9zZWQnICYmIGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSl7XG4gICAgICAgICAgICAgICAgY2xvc2VkQmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnX2hpZGRlbicpXG4gICAgICAgICAgICAgICAgd2lubmVyQmxvY2suY2xhc3NMaXN0LmFkZCgnX2hpZGRlbicpXG4gICAgICAgICAgICAgICAgY2hvb3NlQmxvY2suY2xhc3NMaXN0LmFkZCgnX2hpZGRlbicpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbW92ZVNsaWRlcihvZmZzZXQpIHtcbiAgICAgICAgY3VycmVudEluZGV4ID0gKGN1cnJlbnRJbmRleCArIG9mZnNldCArIHRvdGFsSXRlbXMpICUgdG90YWxJdGVtcztcbiAgICAgICAgdXBkYXRlU2xpZGVyKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaGFuZGxlU3RhcnQoZXZlbnQpIHtcbiAgICAgICAgaXNEcmFnZ2luZyA9IHRydWU7XG4gICAgICAgIHN0YXJ0WCA9IGV2ZW50LmNsaWVudFggfHwgZXZlbnQudG91Y2hlc1swXS5jbGllbnRYO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhhbmRsZU1vdmUoZXZlbnQpIHtcbiAgICAgICAgaWYgKCFpc0RyYWdnaW5nKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgY3VycmVudFggPSBldmVudC5jbGllbnRYIHx8IGV2ZW50LnRvdWNoZXNbMF0uY2xpZW50WDtcbiAgICAgICAgY29uc3QgZGlmZlggPSBjdXJyZW50WCAtIHN0YXJ0WDtcblxuICAgICAgICBpZiAoTWF0aC5hYnMoZGlmZlgpID4gNTApIHtcbiAgICAgICAgICAgIG1vdmVTbGlkZXIoZGlmZlggPiAwID8gLTEgOiAxKTtcbiAgICAgICAgICAgIGlzRHJhZ2dpbmcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhhbmRsZUVuZCgpIHtcbiAgICAgICAgaXNEcmFnZ2luZyA9IGZhbHNlO1xuICAgIH1cblxuICAgIGNvbnN0IGJ1dHRvbnNMZWZ0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZvcm11bGFfX2NvbnRyb2wtbGVmdCcpXG4gICAgY29uc3QgYnV0dG9uc1JpZ2h0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZvcm11bGFfX2NvbnRyb2wtcmlnaHQnKVxuICAgIGJ1dHRvbnNMZWZ0LmZvckVhY2goYnRuICA9PiB7XG4gICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIG1vdmVTbGlkZXIoLTEpO1xuICAgICAgICB9KVxuICAgIH0pXG4gICAgYnV0dG9uc1JpZ2h0LmZvckVhY2goYnRuICA9PiB7XG4gICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIG1vdmVTbGlkZXIoMSk7XG4gICAgICAgIH0pXG4gICAgfSlcblxuICAgIHNsaWRlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBoYW5kbGVTdGFydCk7XG4gICAgc2xpZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBoYW5kbGVTdGFydCk7XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBoYW5kbGVNb3ZlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBoYW5kbGVNb3ZlKTtcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBoYW5kbGVFbmQpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgaGFuZGxlRW5kKTtcblxuICAgIHVwZGF0ZVNsaWRlcigpO1xufSk7XG5cblxuIl19
